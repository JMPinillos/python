1
00:00:00,000 --> 00:00:01,665
こんにちは

2
00:00:01,665 --> 00:00:07,304
では始めましょう

3
00:00:07,304 --> 00:00:11,910
画像データのロードで
取り組んだ演習の答えです

4
00:00:11,910 --> 00:00:14,505
ここでは 変形を定義して 画像フォルダと
実際のデータセットをロードして

5
00:00:14,505 --> 00:00:17,789
このtourch.utilsデータローダを使用して

6
00:00:17,789 --> 00:00:21,509
データローダに変えてもらいました

7
00:00:21,510 --> 00:00:27,855
ここで変形を選択します

8
00:00:27,855 --> 00:00:32,429
まず画像を 255×255の正方形に
サイズ変更します

9
00:00:32,429 --> 00:00:36,630
基本的には 画像が実際には
長方形でも

10
00:00:36,630 --> 00:00:39,135
各辺が 255ピクセルの正方形に
サイズ変更されます

11
00:00:39,134 --> 00:00:44,239
最初に使用した変形は Resizeです

12
00:00:44,240 --> 00:00:47,120
これによって 画像は各辺が255ピクセルの
正方形にサイズ変更されます

13
00:00:47,119 --> 00:00:49,734
元の画像が 長方形であったとしても

14
00:00:49,734 --> 00:00:53,534
これで正方形に変更されます

15
00:00:53,534 --> 00:00:59,464
そして 224ピクセルで
CenterCropを行いました

16
00:00:59,465 --> 00:01:04,284
これによって 画像の中心部分から

17
00:01:04,284 --> 00:01:06,079
一辺が224ピクセルの
正方形が抜き取られます

18
00:01:06,079 --> 00:01:09,439
次に ネットワークに使用できるように
これをテンソルに変換します

19
00:01:09,439 --> 00:01:13,719
変形が定義されていますから
データセットへのパスとともに

20
00:01:13,719 --> 00:01:15,090
この画像フォルダに渡すことで
datasetオブジェクトが作成されます

21
00:01:15,090 --> 00:01:17,070
このdatasetオブジェクトを使用して

22
00:01:17,069 --> 00:01:21,639
データローダに渡すことができます

23
00:01:21,640 --> 00:01:26,295
これによって 画像とラベルを
取得可能なジェネレータが返されます

24
00:01:26,295 --> 00:01:31,010
よって ここでbatch_sizeを32とし
このshuffleをTrueに設定します

25
00:01:31,010 --> 00:01:32,325
基本的には ジェネレータを
複数回ループすると

26
00:01:32,325 --> 00:01:36,010
ループのたびに 画像とラベルが
ランダムにシャッフルされます

27
00:01:36,010 --> 00:01:37,859
ロードすると このようになります

28
00:01:37,859 --> 00:01:40,219
かわいい子犬が表示されています

29
00:01:40,219 --> 00:01:45,019
ここではトレーニングデータと
テストデータの変形を定義してもらいました

30
00:01:45,019 --> 00:01:46,729
説明したように

31
00:01:46,730 --> 00:01:50,090
トレーニングデータを使用するときは
データ拡大を行うのが一般的です

32
00:01:50,090 --> 00:01:51,680
つまりこれを回転

33
00:01:51,680 --> 00:01:53,690
サイズ変更 反転 などして

34
00:01:53,689 --> 00:01:58,810
実際に持っている画像よりも
多く画像の

35
00:01:58,810 --> 00:02:01,265
シミュレートされた
データセットを作成します

36
00:02:01,265 --> 00:02:06,864
これによって トレーニングする
データが多くなり

37
00:02:06,864 --> 00:02:08,979
ネットワークがトレーニングセットに
含まれない画像を一般化するのに役立ちます

38
00:02:08,979 --> 00:02:12,489
ここでの変形では

39
00:02:12,490 --> 00:02:15,140
まず30度のRandomRotationを設定しました

40
00:02:15,139 --> 00:02:17,889
どちらかの方向に
30度回転するということです

41
00:02:17,889 --> 00:02:21,544
そしてRandomResizedCropでは

42
00:02:21,544 --> 00:02:26,000
画像が ランダムにサイズ変更され

43
00:02:26,000 --> 00:02:29,090
中央部が 224ピクセルの正方形に
トリミングされます

44
00:02:29,090 --> 00:02:33,150
トリミングの後で
RandomHorizontalFlipが行われます

45
00:02:33,150 --> 00:02:36,500
画像が水平方向にミラーリングされ
テンソルに変更されます

46
00:02:36,500 --> 00:02:40,205
test_transformsは 前と同様で

47
00:02:40,205 --> 00:02:42,155
255ピクセルに サイズ変更して
224ピクセルで 中央部をトリミング

48
00:02:42,155 --> 00:02:45,860
最後にテンソルに変更します

49
00:02:45,860 --> 00:02:51,560
これらのtrain_dataと

50
00:02:51,560 --> 00:02:52,789
test_dataでは データディレクトリと
変換をデータにロードした

51
00:02:52,789 --> 00:02:56,824
画像フォルダを通して渡すことができます

52
00:02:56,824 --> 00:03:02,009
ロードしたデータをデータローダに渡し

53
00:03:02,009 --> 00:03:07,599
実際にデータセットをロードさせます

