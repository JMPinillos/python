1
00:00:00,000 --> 00:00:05,220
贈り物をもらえるクラスと
もらえないクラスの話に戻ります

2
00:00:05,220 --> 00:00:09,285
クラスが増えたらどうなるでしょうか
見てみましょう

3
00:00:09,285 --> 00:00:10,790
同じような問題があります

4
00:00:10,790 --> 00:00:12,220
ドアが３枚あります

5
00:00:12,220 --> 00:00:14,940
モンティホール問題では
ありませんよ

6
00:00:14,940 --> 00:00:16,860
それぞれのドアの裏には動物がいます

7
00:00:16,860 --> 00:00:19,140
動物は３種類います

8
00:00:19,140 --> 00:00:21,555
アヒルかもしれないし ビーバーかも
しれません

9
00:00:21,555 --> 00:00:23,575
あるいはセイウチかもしれません

10
00:00:23,575 --> 00:00:26,095
では確率表を見てみましょう

11
00:00:26,095 --> 00:00:28,485
表の最初の列を見てみると

12
00:00:28,485 --> 00:00:30,135
１枚目のドアの裏に

13
00:00:30,135 --> 00:00:33,380
アヒルがいる確率は0.7

14
00:00:33,380 --> 00:00:35,800
ビーバーがいる確率は0.2

15
00:00:35,800 --> 00:00:39,080
セイウチがいる確率は0.1です

16
00:00:39,080 --> 00:00:42,150
各列の数字の和が１になる必要があること
に留意してください

17
00:00:42,150 --> 00:00:45,745
各ドアの裏には必ず
何か動物がいるからです

18
00:00:45,745 --> 00:00:50,030
各行の数字は ご覧の通り
足して１になる必要はありません

19
00:00:50,030 --> 00:00:53,825
どのドアの裏にもアヒルがいることも
あり得ますがそれで構いません

20
00:00:53,825 --> 00:00:55,590
サンプルのシナリオを見てみましょう

21
00:00:55,590 --> 00:00:57,225
ドアが３枚あるとします

22
00:00:57,225 --> 00:00:59,775
そして１枚目のドアの裏にはアヒルがいます

23
00:00:59,775 --> 00:01:02,040
２枚目のドアの裏にはセイウチがいます

24
00:01:02,040 --> 00:01:04,805
３枚目のドアの裏にもセイウチがいます

25
00:01:04,805 --> 00:01:07,895
表にあった確率を思い出してください

26
00:01:07,895 --> 00:01:11,555
アヒルが１枚目のドアの裏にいる確率は0.7

27
00:01:11,555 --> 00:01:14,870
セイウチが
２番目のドアの裏にいる確率は0.3

28
00:01:14,870 --> 00:01:18,925
セイウチが３番目のドアの裏にいる確率は
0.4です

29
00:01:18,925 --> 00:01:21,930
この３匹の動物たちになる確率は
３つのイベントの確率の積です

30
00:01:21,930 --> 00:01:25,470
それぞれのイベントは独立しているからで

31
00:01:25,470 --> 00:01:27,900
この場合0.084です

32
00:01:27,900 --> 00:01:30,285
学習したように

33
00:01:30,285 --> 00:01:33,000
ここでの交差エントロピーは

34
00:01:33,000 --> 00:01:37,065
負の確率の対数の和です

35
00:01:37,065 --> 00:01:40,720
ということは１番目は-log 0.7です

36
00:01:40,720 --> 00:01:43,710
２番目は-log 0.3です

37
00:01:43,710 --> 00:01:46,740
３番目は-log 0.4です

38
00:01:46,740 --> 00:01:52,255
交差エントロピーと
この３つの対数の和は2.48になります

39
00:01:52,255 --> 00:01:55,490
でも公式が欲しいので
こで変数を入れます

40
00:01:55,490 --> 00:02:00,187
P₁₁はアヒルが１枚目のドアの裏にいる
確率です

41
00:02:00,187 --> 00:02:04,535
P₁₂はアヒルが２枚目のドアの裏にいる
確率です

42
00:02:04,535 --> 00:02:09,260
指標変数として アヒルがドアJにいれば
y₁j=1 で

43
00:02:09,260 --> 00:02:14,790
ドアJにビーバーがいれば y₂j=1

44
00:02:14,790 --> 00:02:19,285
ドアJにセイウチがいれば y₃j=1 とします

45
00:02:19,285 --> 00:02:21,935
その通りでなければどの変数もゼロです

46
00:02:21,935 --> 00:02:24,210
交差エントロピーの式は

47
00:02:24,210 --> 00:02:27,445
単純にi=1からｎと
y=jからyijのｍまでの

48
00:02:27,445 --> 00:02:35,630
総和にpijの対数を掛けたものです

49
00:02:35,630 --> 00:02:39,150
この場合 m はクラスの数です

50
00:02:39,150 --> 00:02:42,330
この式が機能するのは
ゼロか１であるyijによって

51
00:02:42,330 --> 00:02:45,135
実際に起きたイベントの確率の対数だけが

52
00:02:45,135 --> 00:02:48,555
加算されている保証があるからです

53
00:02:48,555 --> 00:02:53,760
そしてこれが 多クラスの交差エントロピー
の式です

54
00:02:53,760 --> 00:02:55,080
さて最後に問題です

55
00:02:55,080 --> 00:03:00,085
２つのクラス用とｍ個のクラス用の
交差エントロピーの式があるとします

56
00:03:00,085 --> 00:03:04,240
これらの式は違って見えますが
m=2 の場合は同じでしょうか

57
00:03:04,240 --> 00:03:05,565
答えはもちろん「はい」です

58
00:03:05,565 --> 00:03:07,950
ただし実際に書いてみて
本当に同じであることを

59
00:03:07,950 --> 00:03:11,000
自分で納得がいくよう説明してみると
良い訓練になります

